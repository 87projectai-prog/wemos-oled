#include <Arduino.h>
#include <Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>

#define SCREEN_WIDTH 128
#define SCREEN_HEIGHT 64
#define OLED_RESET -1

Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &Wire, OLED_RESET);

/*
  LOGO BITMAP
  48x48
  MONO - VERTICAL - NO SWAP
  Dibuat khusus biar RAPI di OLED
*/
const unsigned char logo_bitmap[] PROGMEM = {
  0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x18,0x18,0x00,0x00,
  0x00,0x00,0x3C,0x3C,0x00,0x00,
  0x00,0x00,0x7E,0x7E,0x00,0x00,
  0x00,0x00,0xE7,0xE7,0x00,0x00,
  0x00,0x01,0xC3,0xC3,0x80,0x00,
  0x00,0x03,0x81,0x81,0xC0,0x00,
  0x00,0x07,0x00,0x00,0xE0,0x00,
  0x00,0x0E,0x00,0x00,0x70,0x00,
  0x00,0x1C,0x00,0x00,0x38,0x00,
  0x00,0x38,0x00,0x00,0x1C,0x00,
  0x00,0x70,0x00,0x00,0x0E,0x00,
  0x00,0xE0,0x00,0x00,0x07,0x00,
  0x01,0xC0,0x00,0x00,0x03,0x80,
  0x03,0x80,0x00,0x00,0x01,0xC0,
  0x07,0x00,0x00,0x00,0x00,0xE0,
  0x03,0x80,0x00,0x00,0x01,0xC0,
  0x01,0xC0,0x00,0x00,0x03,0x80,
  0x00,0xE0,0x00,0x00,0x07,0x00,
  0x00,0x70,0x00,0x00,0x0E,0x00,
  0x00,0x38,0x00,0x00,0x1C,0x00,
  0x00,0x1C,0x00,0x00,0x38,0x00,
  0x00,0x0E,0x00,0x00,0x70,0x00,
  0x00,0x07,0x00,0x00,0xE0,0x00,
  0x00,0x03,0x81,0x81,0xC0,0x00,
  0x00,0x01,0xC3,0xC3,0x80,0x00,
  0x00,0x00,0xE7,0xE7,0x00,0x00,
  0x00,0x00,0x7E,0x7E,0x00,0x00,
  0x00,0x00,0x3C,0x3C,0x00,0x00,
  0x00,0x00,0x18,0x18,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,
};

/* ===== BOOT LOGO ===== */
void showBootLogo() {
  display.clearDisplay();

  display.drawBitmap(
    (SCREEN_WIDTH - 48) / 2,
    0,
    logo_bitmap,
    48,
    48,
    SSD1306_WHITE
  );

  display.setTextSize(1);
  display.setTextColor(SSD1306_WHITE);

  const char* brand = "Mercedes-Benz";
  int16_t x1, y1;
  uint16_t w, h;
  display.getTextBounds(brand, 0, 0, &x1, &y1, &w, &h);
  display.setCursor((SCREEN_WIDTH - w) / 2, 52);
  display.print(brand);

  display.display();
  delay(3000);
}

/* ===== HUD MENU ===== */
void showHud() {
  display.clearDisplay();
  display.setTextSize(1);
  display.setTextColor(SSD1306_WHITE);

  display.setCursor(0, 0);
  display.print("SPD");
  display.setCursor(28, 0);
  display.print("0 km/h");

  display.setCursor(90, 0);
  display.print("READY");

  display.drawLine(0, 10, 127, 10, SSD1306_WHITE);

  display.setCursor(0, 14);
  display.print("RPM  : 0000");

  display.setCursor(0, 26);
  display.print("TEMP : 27 C");

  display.setCursor(0, 38);
  display.print("VOLT : 12.3 V");

  display.drawLine(0, 50, 127, 50, SSD1306_WHITE);

  display.setCursor(36, 54);
  display.print("SYSTEM OK");

  display.display();
}

void setup() {
  delay(300);
  Wire.begin(D2, D1);

  if (!display.begin(SSD1306_SWITCHCAPVCC, 0x3C)) {
    while (1);
  }

  showBootLogo();
  showHud();
}

void loop() {
}
